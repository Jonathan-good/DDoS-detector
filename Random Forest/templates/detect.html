<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
        form>fieldset{
            width: 80%;
            margin: 3% auto auto;
        }

        label.text_label{
            margin-top: 5%;
            margin-bottom: 1%;
        }

    </style>

</head>
<body>
    <h1 class="p-3">Welcome to DDoS detector page!</h1>
    <p class="p-3">Upload the pcap capture file <b>or</b> enter the data to detect the DDoS attack</p>
                <form method="post" action="/detect_file" enctype="multipart/form-data">
                    <fieldset class="form-group border p-3">
                        <legend class="float-none w-auto px-2 file_upload">Option 1: Upload the pcap file</legend>
                        <div class="row justify-content-center">
                            <div class="form-group col-md-6">
                                <input type="file" class="form-control" id="file" name="file">
                                <small class="text-muted">
                                  We'll never share your file with anyone else.
                                </small>
                            </div>
                        </div>
                        <div class="row justify-content-center">
                            <div class="form-group col-md-6">
                                <button type="submit" class="btn btn-primary my-3">Upload</button>
                            </div>
                        </div>
                    </fieldset>
                </form>


                <form method="post" action="/detect_form" enctype="multipart/form-data" class="needs-validation" novalidate>
                    <fieldset class="form-group border p-3">
                        <legend class="float-none w-auto px-2 file_upload">Option 2: Manually upload data</legend>
                        <div class="row justify-content-center">
                            <div class="form_group col-md-6">
                                <label for="src" class="col-form-label text_label">Enter the source IP(x.x.x.x)</label>
                                <input class="form-control" type="text" name="src" placeholder="src" id="src" required>
                            </div>
                        </div>
                        <div class="row justify-content-center">
                            <div class="form_group col-md-6">
                                <label for="dst" class="col-form-label text_label">Enter the destination IP(x.x.x.x)</label>
                                <input class="form-control" type="text" name="dst" placeholder="dst" id="dst" required>
                            </div>
                        </div>
                        <div class="row justify-content-center">
                            <div class="form_group col-md-3">
                                <label for="pktcount" class="col-form-label text_label">Enter the packet count</label>
                                <input type="number" class="form-control" name="pktcount" placeholder="pktcount" id="pktcount" required>
                            </div>
                            <div class="form_group col-md-3">
                                <label for="bytecount" class="col-form-label text_label">Enter the byte count</label>
                                <input type="number" class="form-control" name="bytecount" placeholder="bytecount" id="bytecount" required>
                            </div>
                        </div>
                        <div class="row justify-content-center">
                            <div class="form_group col-md-3">
                                <label for="duration" class="col-form-label text_label">Enter the duration</label>
                                <input type="number" step="0.01" class="form-control" name="dur" placeholder="duration" id="duration" required>
                            </div>
                            <div class="form_group col-md-3">
                                <label for="nsec" class="col-form-label text_label">Enter the duration of nsec</label>
                                <input type="number" class="form-control" name="dur_nsec" placeholder="nsec" id="nsec" required>
                            </div>
                        </div>
                        <div class="row justify-content-center">
                            <div class="form_group col-md-3">
                                <label for="pktrate" class="col-form-label text_label">Enter the packet rate</label>
                                <input type="number" class="form-control" name="pktrate" placeholder="pktrate" id="pktrate" required>
                            </div>
                            <div class="form_group col-md-3">
                                <label for="port_no" class="col-form-label text_label">Enter the port number</label>
                                <input type="number" class="form-control" name="port_no" placeholder="port_no" id="port_no" required>
                            </div>
                        </div>

                        <fieldset class="form-group">
                            <div class="row justify-content-center">
                                <legend class="col-form-label col-md-6 my-2">Protocol</legend>
                                <div class="row justify-content-center">
                                    <div class="form_group col-md-5">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="Protocol" id="ICMP" value="ICMP" required>
                                                <label class="form-check-label" for="ICMP">
                                                     ICMP
                                                </label>
                                        </div>

                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="Protocol" id="TCP" value="TCP" required>
                                                <label class="form-check-label" for="TCP">
                                                    TCP
                                                </label>
                                        </div>

                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="Protocol" id="UDP" value="UDP" required>
                                                <label class="form-check-label" for="UDP">
                                                     UDP
                                                </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                        <div class="row justify-content-center">
                            <div class="form_group col-md-3">
                                <label for="tx_bytes" class="col-form-label text_label">Enter the tx bytes</label>
                                <input type="number" class="form-control" name="tx_bytes" placeholder="tx_bytes" id="tx_bytes" required>
                                <small class="text-muted">
                                  We'll never share your information
                                </small>
                            </div>

                            <div class="form_group col-md-3">
                                <label for="rx_bytes" class="col-form-label text_label">Enter the rx bytes</label>
                                <input type="number" class="form-control" name="rx_bytes" placeholder="rx_bytes" id="rx_bytes" required>
                            </div>
                        </div>


                        <div class="row justify-content-center">

                            <div class="form-group col-md-6">
                                <button type="submit" class="btn btn-secondary my-5">Submit</button>

                            </div>
                        </div>

                    </fieldset>

                </form>

<script>
    (function () {
        'use strict'

        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        let forms = document.querySelectorAll('.needs-validation')

        // Loop over them and prevent submission
        Array.prototype.slice.call(forms).forEach(function (form) {
            form.addEventListener('submit', function (event) {
                if (!form.checkValidity()) {
                  event.preventDefault()
                  event.stopPropagation()
                }

                form.classList.add('was-validated')
            }, false)
        })
    })()
</script>

</body>
</html>